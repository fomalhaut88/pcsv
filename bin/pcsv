#! /usr/bin/env python3

from argparse import ArgumentParser

import pcsv


if __name__ == "__main__":
    parser = ArgumentParser()

    parser.add_argument('cmd', help='command name', choices=['count', 'limit', 'select', 'filter', 'extract', 'sort', 'aggregate'])
    parser.add_argument('-d', '--delimiter', help='delimiter', default=',')
    parser.add_argument('-l', '--limit', help='limit', type=int)
    parser.add_argument('-f', '--fields', help='fields')
    parser.add_argument('-c', '--cond', help='condition')
    parser.add_argument('-e', '--extract', help='extract')
    parser.add_argument('-k', '--key', help='key')
    parser.add_argument('-b', '--begin', help='begin')
    parser.add_argument('-r', '--reduce', help='reduce')
    parser.add_argument('--head', help='head', action='store_true')

    args = parser.parse_args()

    routine = getattr(pcsv, args.cmd)
    routine(args)
